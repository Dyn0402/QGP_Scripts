#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on January 16 12:14 PM 2025
Created in PyCharm
Created as QGP_Scripts/mix_v2_correction_script_for_gang.py

@author: Dylan Neff, Dylan
"""

import matplotlib.pyplot as plt


def main():
    plt.rcParams["figure.figsize"] = (6.66, 5)
    plt.rcParams["figure.dpi"] = 144
    plt.rcParams["font.size"] = 12
    plot_mix_correction_example()
    plt.show()
    print('donzo')


def plot_mix_correction_example():
    # Plot parameters
    series_parameters = {
        'single':
            {'color': 'blue', 'label': 'Single Event', 'marker': 'o'},
        'mix':
            {'color': 'green', 'label': 'Mixed Event', 'marker': 's'},
        'corr':
            {'color': 'red', 'label': 'Single Event - Mixed Event', 'marker': '^'}
    }
    y_range = [-0.00085, 0.00055],
    sys_errorbar_alpha = 0.2

    # Hard coded data
    series_data = {
        'single':
            {'n': [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27],
             'val': [0.0006198122848672, 0.0010032898246477, -4.9029379283194174e-05, -0.000365134125036, -0.000288173528697, -0.0004086250970769, -0.0003528134437404, -0.0003328991512368, -0.0003507926190494, -0.000361397890475, -0.0003469574268973, -0.0003506313548952, -0.0003443618115465, -0.0003006561284192, -0.0003070415173709, -0.0003494511881516, -0.0003417365840558, -0.0002916942619627, -0.0003342353798925, -0.0004288871530992, -0.0003283450587212, -0.0003137184998318, -0.0001662019490917, -0.000451097061104, 8.545330067952533e-05, 8.175351024407018e-05],
             'err': [0.0009134030172175, 0.000289849803203, 0.0001073072998575, 5.990960852389e-05, 3.341718223148334e-05, 2.165542417739048e-05, 1.4997479965664286e-05, 1.2641626061109724e-05, 1.0596527389593334e-05, 9.277942362914546e-06, 8.41142228834697e-06, 8.473439152723077e-06, 8.222479865313737e-06, 8.601703678138571e-06, 1.0434513419701666e-05, 1.2092441066950369e-05, 1.3407937677630392e-05, 1.621820672654532e-05, 2.1384067132797104e-05, 2.433494872215095e-05, 3.9928323629227056e-05, 5.7829762671874505e-05, 7.377781746282536e-05, 0.0001049459427175, 0.0001663437799087, 0.000256241689547],
             'sys': [0.0019796290176604, 0.001655746014149, 0.000594263486484, 0.0003201689938904, 0.0003067517795124, 0.0001141512938068, 9.55385524544132e-05, 0.0001141225828489, 0.0001079373220773, 0.0001219947137234, 6.26916529647502e-05, 0.000119517212603, 0.000118014585252, 4.898758305264327e-05, 6.716168823676597e-05, 8.859010395731837e-05, 9.581797865175272e-05, 0.0001575965909254, 8.65469426567436e-05, 0.0003090134290953, 0.0001962197829349, 0.0003454072191621, 0.0006432065500259, 0.000716589219608, 0.0005805611343759, 0.0007165733304878]},
        'mix':
            {'n': [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27],
             'val': [0.0007299092222654, 0.0002365130487111, 0.0001381988025427, 0.0001241299893527, 0.0001685512711875, 0.0001296714923788, 0.0001268763086254, 0.0001591990116046, 0.0001372567351656, 0.000144134290621, 0.0001358981768177, 0.0001425141224786, 0.0001434966656826, 0.0001560075717331, 0.0001445170091288, 0.0001286707496114, 0.0001271103568132, 0.000118155468798, 0.0001761091799943, 0.0001167603650917, 0.0001673803350368, 9.68341818623012e-05, 0.0001607992940725, 0.0001596073011215, 0.0001521227867124, 0.0003148784889357],
             'err': [0.0002601557826143, 7.938714042991667e-05, 3.481651222235833e-05, 1.72230247969e-05, 1.0258187902476668e-05, 7.448097558690476e-06, 5.040658161678572e-06, 3.9130809086000005e-06, 3.0165356770333333e-06, 2.6716180204418184e-06, 2.54695579751894e-06, 2.7480527122358974e-06, 2.8527687103280222e-06, 2.837506626540953e-06, 3.164625479180833e-06, 3.828664599634559e-06, 4.32541519641634e-06, 5.561700991614035e-06, 7.179723898027895e-06, 9.647450235051669e-06, 1.1718797194124677e-05, 1.693424993320573e-05, 2.4665065450217757e-05, 3.535521300853467e-05, 5.4644717878155535e-05, 7.651703257438988e-05],
             'sys': [0.0026337981805309, 0.0008430020970345, 0.0003777364828335, 0.0001673206460754, 9.127907104649648e-05, 9.989920627583472e-05, 8.247360389800004e-05, 6.97613578298882e-05, 5.576984607823018e-05, 5.106190908468204e-05, 5.6771292803950407e-05, 4.747103303528311e-05, 4.9488195474626805e-05, 6.29369408190063e-05, 4.903858581265551e-05, 7.809849215074215e-05, 7.704787361751983e-05, 0.0001037970069202, 0.0001409920397918, 0.000148860683767, 0.0001488695292924, 0.0002405242011462, 0.0001981159513971, 0.0004039295043132, 0.0003639919950892, 0.0004466442879362]},
        'corr':
            {'n': [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27],
             'val': [-0.0001100969373982, 0.0007667767759365, -0.0001872281818259, -0.0004892641143887, -0.0004567247998845, -0.0005382965894558, -0.0004796897523658, -0.0004920981628414, -0.000488049354215, -0.0005055321810961, -0.0004828556037151, -0.0004931454773739, -0.0004878584772292, -0.0004566637001523, -0.0004515585264998, -0.0004781219377631, -0.0004688469408691, -0.0004098497307608, -0.0005103445598868, -0.000545647518191, -0.0004957253937581, -0.0004105526816941, -0.0003270012431642, -0.0006107043622255, -6.666948603294955e-05, -0.0002331249786916],
             'err': [0.0009497340784543, 0.0003006341237709, 0.0001128336780519, 6.245984834195261e-05, 3.522637156092685e-05, 2.332205088575096e-05, 1.6297036464563482e-05, 1.3989879231811915e-05, 1.1787984413006352e-05, 1.0616331053676603e-05, 9.731096580337104e-06, 9.905021787776084e-06, 9.715225530699536e-06, 1.002148125678234e-05, 1.164854794301001e-05, 1.331211040545399e-05, 1.4624057049884642e-05, 1.7473057495103076e-05, 2.3060276809638023e-05, 2.6503580148028725e-05, 4.186834688533294e-05, 6.034643491547937e-05, 7.786230225837724e-05, 0.0001108433640324, 0.0001750920680331, 0.0002674601561357],
             'sys': [0.0034766014087827, 0.0022380688156979, 0.0006398784717774, 0.0002473086784686, 0.0002500813277, 0.0001128342654305, 7.897259166890713e-05, 9.143893786588643e-05, 0.0001075216549816, 7.812894253892169e-05, 4.208467764187556e-05, 7.9296344803795e-05, 9.386017896697402e-05, 5.3401126205078e-05, 7.38510720493188e-05, 7.084895018049828e-05, 9.729828761653291e-05, 0.0001908948538866, 0.0001943172827867, 0.0002889570045241, 0.0002778915456573, 0.0003146174122981, 0.0007076291504003, 0.0008271382366871, 0.0007322298572726, 0.000658142872323]}
    }

    fig, ax = plt.subplots()
    fig.canvas.manager.set_window_title(f'dvar vs Total Protons 39GeV 120Â°')
    for series in series_data:
        ax.errorbar(series_data[series]['n'], series_data[series]['val'], yerr=series_data[series]['err'],
                    fmt=series_parameters[series]['marker'], color=series_parameters[series]['color'],
                    label=series_parameters[series]['label'], zorder=2)
        ax.errorbar(series_data[series]['n'], series_data[series]['val'], yerr=series_data[series]['sys'],
                    marker='', ls='', elinewidth=4, color=series_parameters[series]['color'], alpha=sys_errorbar_alpha,
                    zorder=1)
    ax.axhline(0, ls='-', color='gray', zorder=0)

    ax.set_ylim(*y_range)

    ax.set_ylabel(r'$\Delta \sigma^2$')
    ax.set_xlabel(r'Number of Protons in Event ($N$)')
    eta_line = r'|y| < 0.5'
    pt_line = r'0.4 < $p_T$ < 2.0 GeV'
    ax.text(0.26, 0.93, f'Au+Au\n{eta_line}\n{pt_line}', ha='left', va='top', transform=ax.transAxes)
    ax.legend(loc='lower center')

    fig.tight_layout()
    fig.subplots_adjust(top=0.995, right=0.995, bottom=0.1, left=0.165)


if __name__ == '__main__':
    main()
