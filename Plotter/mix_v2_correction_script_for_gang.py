#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on January 16 12:14 PM 2025
Created in PyCharm
Created as QGP_Scripts/mix_v2_correction_script_for_gang.py

@author: Dylan Neff, Dylan
"""

import matplotlib.pyplot as plt
import numpy as np


def main():
    plt.rcParams["figure.figsize"] = (6.66, 5)
    plt.rcParams["figure.dpi"] = 144
    plt.rcParams["font.size"] = 12
    # plot_mix_correction_example()
    plot_sys_comparison()
    plt.show()
    print('donzo')


def plot_mix_correction_example():
    # Plot parameters
    series_parameters = {
        'single':
            {'color': 'blue', 'label': 'Single Event', 'marker': 'o'},
        'mix':
            {'color': 'green', 'label': 'Mixed Event', 'marker': 's'},
        'corr':
            {'color': 'red', 'label': 'Single Event - Mixed Event', 'marker': '^'}
    }
    y_range = [-0.00085, 0.00055],
    sys_errorbar_alpha = 0.2

    # Hard coded data
    series_data = {
        'single':
            {'n': [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27],
             'val': [0.0006198122848672, 0.0010032898246477, -4.9029379283194174e-05, -0.000365134125036, -0.000288173528697, -0.0004086250970769, -0.0003528134437404, -0.0003328991512368, -0.0003507926190494, -0.000361397890475, -0.0003469574268973, -0.0003506313548952, -0.0003443618115465, -0.0003006561284192, -0.0003070415173709, -0.0003494511881516, -0.0003417365840558, -0.0002916942619627, -0.0003342353798925, -0.0004288871530992, -0.0003283450587212, -0.0003137184998318, -0.0001662019490917, -0.000451097061104, 8.545330067952533e-05, 8.175351024407018e-05],
             'err': [0.0009134030172175, 0.000289849803203, 0.0001073072998575, 5.990960852389e-05, 3.341718223148334e-05, 2.165542417739048e-05, 1.4997479965664286e-05, 1.2641626061109724e-05, 1.0596527389593334e-05, 9.277942362914546e-06, 8.41142228834697e-06, 8.473439152723077e-06, 8.222479865313737e-06, 8.601703678138571e-06, 1.0434513419701666e-05, 1.2092441066950369e-05, 1.3407937677630392e-05, 1.621820672654532e-05, 2.1384067132797104e-05, 2.433494872215095e-05, 3.9928323629227056e-05, 5.7829762671874505e-05, 7.377781746282536e-05, 0.0001049459427175, 0.0001663437799087, 0.000256241689547],
             'sys': [0.0019796290176604, 0.001655746014149, 0.000594263486484, 0.0003201689938904, 0.0003067517795124, 0.0001141512938068, 9.55385524544132e-05, 0.0001141225828489, 0.0001079373220773, 0.0001219947137234, 6.26916529647502e-05, 0.000119517212603, 0.000118014585252, 4.898758305264327e-05, 6.716168823676597e-05, 8.859010395731837e-05, 9.581797865175272e-05, 0.0001575965909254, 8.65469426567436e-05, 0.0003090134290953, 0.0001962197829349, 0.0003454072191621, 0.0006432065500259, 0.000716589219608, 0.0005805611343759, 0.0007165733304878]},
        'mix':
            {'n': [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27],
             'val': [0.0007299092222654, 0.0002365130487111, 0.0001381988025427, 0.0001241299893527, 0.0001685512711875, 0.0001296714923788, 0.0001268763086254, 0.0001591990116046, 0.0001372567351656, 0.000144134290621, 0.0001358981768177, 0.0001425141224786, 0.0001434966656826, 0.0001560075717331, 0.0001445170091288, 0.0001286707496114, 0.0001271103568132, 0.000118155468798, 0.0001761091799943, 0.0001167603650917, 0.0001673803350368, 9.68341818623012e-05, 0.0001607992940725, 0.0001596073011215, 0.0001521227867124, 0.0003148784889357],
             'err': [0.0002601557826143, 7.938714042991667e-05, 3.481651222235833e-05, 1.72230247969e-05, 1.0258187902476668e-05, 7.448097558690476e-06, 5.040658161678572e-06, 3.9130809086000005e-06, 3.0165356770333333e-06, 2.6716180204418184e-06, 2.54695579751894e-06, 2.7480527122358974e-06, 2.8527687103280222e-06, 2.837506626540953e-06, 3.164625479180833e-06, 3.828664599634559e-06, 4.32541519641634e-06, 5.561700991614035e-06, 7.179723898027895e-06, 9.647450235051669e-06, 1.1718797194124677e-05, 1.693424993320573e-05, 2.4665065450217757e-05, 3.535521300853467e-05, 5.4644717878155535e-05, 7.651703257438988e-05],
             'sys': [0.0026337981805309, 0.0008430020970345, 0.0003777364828335, 0.0001673206460754, 9.127907104649648e-05, 9.989920627583472e-05, 8.247360389800004e-05, 6.97613578298882e-05, 5.576984607823018e-05, 5.106190908468204e-05, 5.6771292803950407e-05, 4.747103303528311e-05, 4.9488195474626805e-05, 6.29369408190063e-05, 4.903858581265551e-05, 7.809849215074215e-05, 7.704787361751983e-05, 0.0001037970069202, 0.0001409920397918, 0.000148860683767, 0.0001488695292924, 0.0002405242011462, 0.0001981159513971, 0.0004039295043132, 0.0003639919950892, 0.0004466442879362]},
        'corr':
            {'n': [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27],
             'val': [-0.0001100969373982, 0.0007667767759365, -0.0001872281818259, -0.0004892641143887, -0.0004567247998845, -0.0005382965894558, -0.0004796897523658, -0.0004920981628414, -0.000488049354215, -0.0005055321810961, -0.0004828556037151, -0.0004931454773739, -0.0004878584772292, -0.0004566637001523, -0.0004515585264998, -0.0004781219377631, -0.0004688469408691, -0.0004098497307608, -0.0005103445598868, -0.000545647518191, -0.0004957253937581, -0.0004105526816941, -0.0003270012431642, -0.0006107043622255, -6.666948603294955e-05, -0.0002331249786916],
             'err': [0.0009497340784543, 0.0003006341237709, 0.0001128336780519, 6.245984834195261e-05, 3.522637156092685e-05, 2.332205088575096e-05, 1.6297036464563482e-05, 1.3989879231811915e-05, 1.1787984413006352e-05, 1.0616331053676603e-05, 9.731096580337104e-06, 9.905021787776084e-06, 9.715225530699536e-06, 1.002148125678234e-05, 1.164854794301001e-05, 1.331211040545399e-05, 1.4624057049884642e-05, 1.7473057495103076e-05, 2.3060276809638023e-05, 2.6503580148028725e-05, 4.186834688533294e-05, 6.034643491547937e-05, 7.786230225837724e-05, 0.0001108433640324, 0.0001750920680331, 0.0002674601561357],
             'sys': [0.0034766014087827, 0.0022380688156979, 0.0006398784717774, 0.0002473086784686, 0.0002500813277, 0.0001128342654305, 7.897259166890713e-05, 9.143893786588643e-05, 0.0001075216549816, 7.812894253892169e-05, 4.208467764187556e-05, 7.9296344803795e-05, 9.386017896697402e-05, 5.3401126205078e-05, 7.38510720493188e-05, 7.084895018049828e-05, 9.729828761653291e-05, 0.0001908948538866, 0.0001943172827867, 0.0002889570045241, 0.0002778915456573, 0.0003146174122981, 0.0007076291504003, 0.0008271382366871, 0.0007322298572726, 0.000658142872323]}
    }

    fig, ax = plt.subplots()
    fig.canvas.manager.set_window_title(f'dvar vs Total Protons 39GeV 120째')
    for series in series_data:
        ax.errorbar(series_data[series]['n'], series_data[series]['val'], yerr=series_data[series]['err'],
                    fmt=series_parameters[series]['marker'], color=series_parameters[series]['color'],
                    label=series_parameters[series]['label'], zorder=2)
        ax.errorbar(series_data[series]['n'], series_data[series]['val'], yerr=series_data[series]['sys'],
                    marker='', ls='', elinewidth=4, color=series_parameters[series]['color'], alpha=sys_errorbar_alpha,
                    zorder=1)
    ax.axhline(0, ls='-', color='gray', zorder=0)

    ax.set_ylim(*y_range)

    ax.set_ylabel(r'$\Delta \sigma^2$')
    ax.set_xlabel(r'Number of Protons in Event ($N$)')
    eta_line = r'|y| < 0.5'
    pt_line = r'0.4 < $p_T$ < 2.0 GeV'
    ax.text(0.26, 0.93, f'Au+Au\n{eta_line}\n{pt_line}', ha='left', va='top', transform=ax.transAxes)
    ax.legend(loc='lower center')

    fig.tight_layout()
    fig.subplots_adjust(top=0.995, right=0.995, bottom=0.1, left=0.165)


def plot_sys_comparison():
    # Plot parameters
    series_parameters = {
        'default':
            {'color': 'blue', 'label': 'default', 'marker': 'o'},
        # 'nhitfit15':
        #     {'color': 'green', 'label': 'NHitsFit > 15', 'marker': 's'},
        # 'nhitfit25':
        #     {'color': 'red', 'label': 'NHitsFit > 25', 'marker': '^'},
        'dca08':
            {'color': 'purple', 'label': 'DCA < 0.8', 'marker': 'd'},
        'dca12':
            {'color': 'orange', 'label': 'DCA < 1.2', 'marker': 'v'},
        # 'vzlow':
        #     {'color': 'cyan', 'label': 'vz = [-30, -7]', 'marker': 'p'},
        # 'vzhigh':
        #     {'color': 'magenta', 'label': 'vz = [7, 30]', 'marker': 'P'},
        # 'vzmid':
        #     {'color': 'brown', 'label': 'vz = [-5, 5]', 'marker': 'X'},
    }
    y_range = [-0.00119, 0.00069],
    x_range = [4.5, 24.5],
    sys_errorbar_alpha = 0.2
    sys_errorbar_width = 20
    kin_loc = (0.6, 0.93)
    title_loc = (0.5, 0.05)

    # Hard coded data
    series_data = {
        'nhitfit15': {
            'n': [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28],
            'val': [-0.00190856229350535, 0.0004247017988181, -0.00014208326439645, -0.000540768910525945,
                    -0.0005247226790018966, -0.0005200120652993571, -0.00047923310344235713, -0.0005285322656536236,
                    -0.0005008670900784911, -0.0005092547632765928, -0.0004860040805631682, -0.0004952665790593539,
                    -0.0005010557924047736, -0.00046209035173451376, -0.00047494287709966585, -0.0004768032164335331,
                    -0.0004747829585064082, -0.00044387002042606315, -0.0004763096358445576, -0.0005946684266114914,
                    -0.00045573090639458266, -0.00045766846895974386, -0.0004278186017579136, -0.0004758296834837783,
                    -9.644150092386877e-05, -0.00012750399295981537, -0.0009177765927673579],
            'err': [0.0011064169614324571, 0.00033898982311505614, 0.00014208432817163215, 7.019438595772165e-05,
                    3.792011205904159e-05, 2.549864266396899e-05, 1.821715104052152e-05, 1.463704844046351e-05,
                    1.1690622035470328e-05, 1.0694045979005411e-05, 9.481444151318386e-06, 9.48608905081844e-06,
                    8.878722716166618e-06, 1.0505048847041175e-05, 1.0461928125081266e-05, 1.2175068293461573e-05,
                    1.3350001079742974e-05, 1.695789335593903e-05, 2.052570699760106e-05, 2.5473864212210212e-05,
                    3.2460868097301546e-05, 4.7853636536544784e-05, 6.341807959537177e-05, 8.535113606208611e-05,
                    0.0001344537783550933, 0.00019891160986975392, 0.00027041271126830894]
        },
        'nhitfit25': {
            'n': [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25],
            'val': [-0.00021388882487055, 2.2684165724833337e-05, -0.000501027546275, -0.0004509864315094,
                    -0.00047476087685589997, -0.000482032563194731, -0.00045157350992724104, -0.0004352086099580334,
                    -0.0004583268381226445, -0.00045035327056360637, -0.0004816150876998629, -0.00044491035466560387,
                    -0.00041070477009798903, -0.00043931692787592473, -0.0004279690534081929, -0.0004536583870564162,
                    -0.0004981067208221265, -0.000423742059114345, -0.0004710457059281242, -0.0004864765810270069,
                    -0.0004588403178536234, -0.00041661960230301347, -0.00010409473903101395, -0.00021857416961890285],
            'err': [0.0006874136869592577, 0.00020106983395184688, 8.300409411591285e-05, 4.904930699483614e-05,
                    2.848084744175342e-05, 2.0176086544443732e-05, 1.524206425748481e-05, 1.2846607692027916e-05,
                    1.1835152239743059e-05, 1.1173845301563832e-05, 1.0428917779757804e-05, 1.0730098652211033e-05,
                    1.1199629671489238e-05, 1.2586384987585939e-05, 1.415694248055333e-05, 1.7950001701278942e-05,
                    2.0170456188244496e-05, 2.588306175469424e-05, 3.467861407744195e-05, 4.5397592667678185e-05,
                    7.08812476234493e-05, 9.076372617544474e-05, 0.00014223038115384297, 0.00019977192136935484]
        },
        'dca08': {
            'n': [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26],
            'val': [0.0001350966648355, 0.0006057488378963333, -0.00021436640322335834, -0.00060345906080371,
                    -0.00040612051236573333, -0.0005627510351456762, -0.0004902122970548107, -0.00047192841786130414,
                    -0.0005349254885868967, -0.0005228464616753482, -0.0004941038207209841, -0.0005140262796242942,
                    -0.00048450911282372307, -0.0004526504087937348, -0.0004645672694849446, -0.00047147527704756177,
                    -0.00043461075042250423, -0.0005405476727685155, -0.0005271201251021326, -0.0005827486238767912,
                    -0.00037493174638628725, -0.0005740821998697268, -0.0004103534234337725, -0.0003284809846507342,
                    3.951621717420292e-05],
            'err': [0.000746074529048004, 0.00023042843167187503, 9.057635973153904e-05, 5.012294505714707e-05,
                    2.6641941701045313e-05, 2.070890782699692e-05, 1.5996759068987337e-05, 1.3438788309707922e-05,
                    1.1664075633054689e-05, 1.065807463244985e-05, 1.0243010401309232e-05, 1.0658020607180391e-05,
                    1.0611258149863533e-05, 1.198097961235133e-05, 1.3267624153821199e-05, 1.5738430982595292e-05,
                    1.8821950104698104e-05, 2.39709843924566e-05, 3.296183212722425e-05, 4.480896345663634e-05,
                    6.299617870746327e-05, 8.553326670873486e-05, 0.00013072205304217214, 0.0001888761411099295,
                    0.00029910212333893464]
        },
        'dca12': {
            'n': [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28],
            'val': [0.0004439782894536, 0.0005144552428230166, -0.00023321855442505834, -0.000482995906517845,
                    -0.00034561124930751003, -0.0005449642523147452, -0.00048818918687445177, -0.0004608938148064333,
                    -0.00047416552274195776, -0.0004641760686482209, -0.000498221921232719, -0.00048406042087422563,
                    -0.0004749560697494137, -0.0004869787976080424, -0.0004152048193234762, -0.0004745027834601794,
                    -0.00045774874009417974, -0.0004428453357841678, -0.00041006934715146154, -0.00045738153334993906,
                    -0.0005323339068225593, -0.0004108793728757585, -0.0003969635748363877, -0.0004990918210601011,
                    -0.000515567783381842, -0.0006239366160740474, -0.000652395110282907],
            'err': [0.0012583687126898975, 0.0003690330178427547, 0.00013720353951596095, 7.008258294258267e-05,
                    4.2152906980150806e-05, 2.7093941202039327e-05, 1.8314921378980268e-05, 1.4904446858622545e-05,
                    1.1912875841732516e-05, 1.1174733831843121e-05, 1.0217754363984694e-05, 9.5226296876027e-06,
                    8.932097504677076e-06, 9.92340890392369e-06, 1.0003005664989337e-05, 1.2040422489738596e-05,
                    1.3763916307847322e-05, 1.5420938292763735e-05, 1.8053648639109104e-05, 2.317023582147818e-05,
                    3.2434699050688776e-05, 4.258729083604122e-05, 5.4590825333732995e-05, 8.21163926498568e-05,
                    0.00013302542953933752, 0.00018262537394747, 0.00023651730451792574]
        },
        'vzlow': {
            'n': [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25],
            'val': [0.001693927071873, 0.0013415540092543666, -0.0006356263634464666, -0.000311271951652045,
                    -0.00033187056659010335, -0.0005783233221093476, -0.0005351162367097714, -0.0005040960625594597,
                    -0.0005092860886059378, -0.00046954963890260637, -0.0004860837021938917, -0.00045145486400029937,
                    -0.000506593616458534, -0.0004486025752620281, -0.0004984737402240854, -0.0004897021232394003,
                    -0.00043255858347083755, -0.00046778260341915, -0.0005194245267923319, -0.0007132326125393607,
                    -0.0003751206862576855, -0.00034686944603225353, -0.00021213115558380415, -0.00031391946957211265],
            'err': [0.0015076740091002102, 0.0004716621678783165, 0.00019714124868633884, 0.00010609949281824676,
                    6.441179838462237e-05, 3.8776741655608404e-05, 2.6022749793163334e-05, 2.281021903650758e-05,
                    1.936413964129068e-05, 1.710667821703481e-05, 1.6206282107025013e-05, 1.6033234899711292e-05,
                    1.6976173291631693e-05, 1.8144103983801453e-05, 2.0527258859256515e-05, 2.3239742350888713e-05,
                    2.623858403600448e-05, 3.376142380370238e-05, 4.246828922009888e-05, 5.1800787254196964e-05,
                    7.736886513566529e-05, 0.00011330409154698889, 0.00012603229384101336, 0.00022245654667665455]
        },
        'vzhigh': {
            'n': [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26],
            'val': [0.0017964058180062, 0.00011769359038698333, 0.00010234042665378333, -0.00067061706279767,
                    -0.0006432367669920866, -0.0005464885858399787, -0.00043474749141243036, -0.0004950430673588986,
                    -0.0005208589293535345, -0.0005179219321277709, -0.0005064958910256295, -0.0005006538056979519,
                    -0.0005063342911131879, -0.0004306819443613295, -0.00041993130400212964, -0.0005103133773806195,
                    -0.0004936504882283703, -0.0004657025288279024, -0.0003849720528970721, -0.0006363641014397092,
                    -0.0005841604164418513, -0.0004895577991311151, -0.0004906778143929585, -0.0007921330524206995,
                    -5.838490122833723e-05],
            'err': [0.0016349221275977332, 0.0004696598079519308, 0.0001908827700545509, 9.827745425772363e-05,
                    5.9554362189043594e-05, 3.71007764302564e-05, 2.837444051736289e-05, 2.228086373726511e-05,
                    1.6646822704725417e-05, 1.6700299226167156e-05, 1.4828220900122592e-05, 1.5285683510092648e-05,
                    1.5244959111304071e-05, 1.7093763668146732e-05, 1.6470602324042415e-05, 1.930081530395828e-05,
                    2.3637940709600973e-05, 2.985234197832891e-05, 3.48966236358077e-05, 4.7052407464873714e-05,
                    5.639947618007809e-05, 8.694522085308087e-05, 0.00011467687238046879, 0.000156994788353299,
                    0.00023337047334504637]
        },
        'vzmid': {
            'n': [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25],
            'val': [-0.00262234903281125, 0.0027300411214942334, -1.5297649465891667e-05, -0.000583646803251745,
                    -0.0005161497555818067, -0.0005034546181216762, -0.0005413299594517821, -0.00043731238791539444,
                    -0.0004033401519131855, -0.0005053538893621945, -0.00046635438936798185, -0.0004745288477717731,
                    -0.0004490668535337736, -0.00043136693137711766, -0.0004293648766847079, -0.000524465399830164,
                    -0.0005366044956027883, -0.0003657923236092725, -0.00048788113502141214, -0.000494799894712174,
                    -0.0004880886548865691, -0.0006119315128710781, -0.0007613501260834612, -0.0012477968106947691],
            'err': [0.0021519201971251733, 0.0006850570721729857, 0.00029002964247132036, 0.0001430030725774053,
                    7.727323172696974e-05, 5.2582536425801726e-05, 4.044721795683466e-05, 2.7910696911278803e-05,
                    2.4180984408648834e-05, 2.0015226418917653e-05, 1.961909469384399e-05, 1.882908077011675e-05,
                    1.9664316972163987e-05, 2.23769453350623e-05, 2.3948486525498124e-05, 2.7782135742442188e-05,
                    3.47116177165101e-05, 4.2033707295590785e-05, 4.991207471277561e-05, 6.364204228265163e-05,
                    9.173994514958675e-05, 0.00011824196658917935, 0.00019134637398870056, 0.0002670967397844501]
        },
        'default':
            {'n': [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27],
             'val': [-0.0001100969373982, 0.0007667767759365, -0.0001872281818259, -0.0004892641143887,
                     -0.0004567247998845, -0.0005382965894558, -0.0004796897523658, -0.0004920981628414,
                     -0.000488049354215, -0.0005055321810961, -0.0004828556037151, -0.0004931454773739,
                     -0.0004878584772292, -0.0004566637001523, -0.0004515585264998, -0.0004781219377631,
                     -0.0004688469408691, -0.0004098497307608, -0.0005103445598868, -0.000545647518191,
                     -0.0004957253937581, -0.0004105526816941, -0.0003270012431642, -0.0006107043622255,
                     -6.666948603294955e-05, -0.0002331249786916],
             'err': [0.0009497340784543, 0.0003006341237709, 0.0001128336780519, 6.245984834195261e-05,
                     3.522637156092685e-05, 2.332205088575096e-05, 1.6297036464563482e-05, 1.3989879231811915e-05,
                     1.1787984413006352e-05, 1.0616331053676603e-05, 9.731096580337104e-06, 9.905021787776084e-06,
                     9.715225530699536e-06, 1.002148125678234e-05, 1.164854794301001e-05, 1.331211040545399e-05,
                     1.4624057049884642e-05, 1.7473057495103076e-05, 2.3060276809638023e-05, 2.6503580148028725e-05,
                     4.186834688533294e-05, 6.034643491547937e-05, 7.786230225837724e-05, 0.0001108433640324,
                     0.0001750920680331, 0.0002674601561357],
             'sys': [0.0034766014087827, 0.0022380688156979, 0.0006398784717774, 0.0002473086784686, 0.0002500813277,
                     0.0001128342654305, 7.897259166890713e-05, 9.143893786588643e-05, 0.0001075216549816,
                     7.812894253892169e-05, 4.208467764187556e-05, 7.9296344803795e-05, 9.386017896697402e-05,
                     5.3401126205078e-05, 7.38510720493188e-05, 7.084895018049828e-05, 9.729828761653291e-05,
                     0.0001908948538866, 0.0001943172827867, 0.0002889570045241, 0.0002778915456573, 0.0003146174122981,
                     0.0007076291504003, 0.0008271382366871, 0.0007322298572726, 0.000658142872323]}
    }

    fig, ax = plt.subplots()
    fig.canvas.manager.set_window_title(f'dvar vs Total Protons 39GeV 120째')
    for series in series_parameters:
        ax.errorbar(series_data[series]['n'], series_data[series]['val'], yerr=series_data[series]['err'],
                    fmt=series_parameters[series]['marker'], color=series_parameters[series]['color'],
                    label=series_parameters[series]['label'], zorder=2)
        if 'sys' in series_data[series]:
            ax.errorbar(series_data[series]['n'], series_data[series]['val'], yerr=series_data[series]['sys'],
                        marker='', ls='', elinewidth=sys_errorbar_width, color=series_parameters[series]['color'],
                        alpha=sys_errorbar_alpha, zorder=1)
    ax.axhline(0, ls='-', color='gray', zorder=0)

    ax.set_ylim(*y_range)
    ax.set_xlim(*x_range)

    ax.set_ylabel(r'$\Delta \sigma^2$')
    ax.set_xlabel(r'Number of Protons in Event ($N$)')
    eta_line = r'|y| < 0.5'
    pt_line = r'0.4 < $p_T$ < 2.0 GeV'
    ax.text(*kin_loc, f'Au+Au\n{eta_line}\n{pt_line}', ha='left', va='top', transform=ax.transAxes)
    ax.text(*title_loc, 'Original Systematic Error', ha='center', va='bottom', transform=ax.transAxes)
    ax.legend(loc='upper left')

    fig.tight_layout()
    fig.subplots_adjust(top=0.995, right=0.995, bottom=0.1, left=0.182)

    fig2, ax2 = plt.subplots()
    fig2.canvas.manager.set_window_title(f'dvar vs Total Protons 39GeV 120째 sqrt(12)')
    for series in series_parameters:
        ax2.errorbar(series_data[series]['n'], series_data[series]['val'], yerr=series_data[series]['err'],
                    fmt=series_parameters[series]['marker'], color=series_parameters[series]['color'],
                    label=series_parameters[series]['label'], zorder=2)
        if 'sys' in series_data[series]:
            ax2.errorbar(series_data[series]['n'], series_data[series]['val'], yerr=series_data[series]['sys'] / np.sqrt(12),
                        marker='', ls='', elinewidth=sys_errorbar_width, color=series_parameters[series]['color'],
                        alpha=sys_errorbar_alpha, zorder=1)
    ax2.axhline(0, ls='-', color='gray', zorder=0)

    ax2.set_ylim(*y_range)
    ax2.set_xlim(*x_range)

    ax2.set_ylabel(r'$\Delta \sigma^2$')
    ax2.set_xlabel(r'Number of Protons in Event ($N$)')
    ax2.text(*kin_loc, f'Au+Au\n{eta_line}\n{pt_line}', ha='left', va='top', transform=ax.transAxes)
    ax2.text(*title_loc, r'Systematic Error / $\sqrt{12}$', ha='center', va='bottom', transform=ax.transAxes)
    ax2.legend(loc='upper left')

    fig2.tight_layout()
    fig2.subplots_adjust(top=0.995, right=0.995, bottom=0.1, left=0.182)

    fig3, ax3 = plt.subplots()
    fig3.canvas.manager.set_window_title(f'dvar vs Total Protons 39GeV 120째 sqrt(3)')
    for series in series_parameters:
        ax3.errorbar(series_data[series]['n'], series_data[series]['val'], yerr=series_data[series]['err'],
                    fmt=series_parameters[series]['marker'], color=series_parameters[series]['color'],
                    label=series_parameters[series]['label'], zorder=2)
        if 'sys' in series_data[series]:
            ax3.errorbar(series_data[series]['n'], series_data[series]['val'], yerr=series_data[series]['sys'] / np.sqrt(3),
                        marker='', ls='', elinewidth=sys_errorbar_width, color=series_parameters[series]['color'],
                        alpha=sys_errorbar_alpha, zorder=1)
    ax3.axhline(0, ls='-', color='gray', zorder=0)

    ax3.set_ylim(*y_range)
    ax3.set_xlim(*x_range)

    ax3.set_ylabel(r'$\Delta \sigma^2$')
    ax3.set_xlabel(r'Number of Protons in Event ($N$)')
    ax3.text(*kin_loc, f'Au+Au\n{eta_line}\n{pt_line}', ha='left', va='top', transform=ax.transAxes)
    ax3.text(*title_loc, r'Systematic Error / $\sqrt{3}$', ha='center', va='bottom', transform=ax.transAxes)
    ax3.legend(loc='upper left')

    fig3.tight_layout()
    fig3.subplots_adjust(top=0.995, right=0.995, bottom=0.1, left=0.182)


if __name__ == '__main__':
    main()
